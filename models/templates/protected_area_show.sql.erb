SELECT
  protected_areas.wdpa_id AS wdpa_id,
  protected_areas.name AS name,
  ST_AsGeoJSON(ST_SimplifyPreserveTopology(protected_areas.the_geom, 0.00003), 3) AS geojson,
  protected_areas.original_name AS original_name,
  protected_areas.marine AS marine,
  countries.name AS country_name,
  countries.iso_3 AS country_iso_3,
  sub_locations.id AS sub_location_id,
  sub_locations.english_name AS sub_location_english_name,
  iucn_categories.id AS iucn_category_id,
  iucn_categories.name AS iucn_category_name,
  designations.id AS designation_id,
  designations.name AS designation_name
FROM protected_areas
  LEFT JOIN countries_protected_areas     ON protected_areas.id = countries_protected_areas.protected_area_id
  LEFT JOIN countries                     ON countries.id = countries_protected_areas.country_id
  LEFT JOIN protected_areas_sub_locations ON protected_areas.id = protected_areas_sub_locations.protected_area_id
  LEFT JOIN sub_locations                 ON sub_locations.id = protected_areas_sub_locations.sub_location_id
  LEFT JOIN iucn_categories               ON iucn_categories.id = protected_areas.iucn_category_id
  LEFT JOIN designations                  ON designations.id = protected_areas.designation_id
WHERE protected_areas.wdpa_id = '<%= wdpa_id %>'
LIMIT 1
